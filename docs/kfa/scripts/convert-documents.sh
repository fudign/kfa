#!/bin/bash

# ================================================================
# –°–ö–†–ò–ü–¢ –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò –î–û–ö–£–ú–ï–ù–¢–û–í –ö–§–ê
# ================================================================
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Markdown ‚Üí PDF, DOCX
# –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
# ================================================================

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ —Å —Ü–≤–µ—Ç–æ–º
print_info() { echo -e "${BLUE}[INFO]${NC} $1"; }
print_success() { echo -e "${GREEN}[SUCCESS]${NC} $1"; }
print_warning() { echo -e "${YELLOW}[WARNING]${NC} $1"; }
print_error() { echo -e "${RED}[ERROR]${NC} $1"; }

# ================================================================
# –ù–ê–°–¢–†–û–ô–ö–ò
# ================================================================

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
DOCS_DIR="$(cd "$(dirname "$0")/.." && pwd)"
OUTPUT_DIR="$DOCS_DIR/output"
PDF_DIR="$OUTPUT_DIR/pdf"
DOCX_DIR="$OUTPUT_DIR/docx"
ARCHIVES_DIR="$OUTPUT_DIR/archives"

# –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p "$PDF_DIR/charter"
mkdir -p "$PDF_DIR/regulations"
mkdir -p "$PDF_DIR/web"
mkdir -p "$PDF_DIR/forms"
mkdir -p "$DOCX_DIR/charter"
mkdir -p "$DOCX_DIR/regulations"
mkdir -p "$DOCX_DIR/web"
mkdir -p "$DOCX_DIR/forms"
mkdir -p "$ARCHIVES_DIR"

# –õ–æ–≥ —Ñ–∞–π–ª
LOG_FILE="$OUTPUT_DIR/conversion.log"
echo "=== –ù–∞—á–∞–ª–æ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: $(date) ===" > "$LOG_FILE"

# ================================================================
# –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
# ================================================================

print_info "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."

if ! command -v pandoc &> /dev/null; then
    print_error "pandoc –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: sudo apt-get install pandoc"
    exit 1
fi

if ! command -v zip &> /dev/null; then
    print_error "zip –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: sudo apt-get install zip"
    exit 1
fi

print_success "–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"

# ================================================================
# –§–£–ù–ö–¶–ò–ò –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò
# ================================================================

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è MD ‚Üí PDF
convert_to_pdf() {
    local input_file="$1"
    local output_file="$2"

    print_info "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF: $(basename "$input_file")"

    pandoc "$input_file" \
        -o "$output_file" \
        --pdf-engine=xelatex \
        -V geometry:margin=2cm \
        -V fontsize=12pt \
        -V documentclass=article \
        -V lang=ru \
        --toc \
        --toc-depth=3 \
        2>> "$LOG_FILE"

    if [ $? -eq 0 ]; then
        print_success "PDF —Å–æ–∑–¥–∞–Ω: $(basename "$output_file")"
    else
        print_error "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF: $(basename "$input_file")"
    fi
}

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è MD ‚Üí DOCX
convert_to_docx() {
    local input_file="$1"
    local output_file="$2"

    print_info "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ DOCX: $(basename "$input_file")"

    pandoc "$input_file" \
        -o "$output_file" \
        -V lang=ru \
        --toc \
        --toc-depth=3 \
        2>> "$LOG_FILE"

    if [ $? -eq 0 ]; then
        print_success "DOCX —Å–æ–∑–¥–∞–Ω: $(basename "$output_file")"
    else
        print_error "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ DOCX: $(basename "$input_file")"
    fi
}

# ================================================================
# –ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –£–ß–†–ï–î–ò–¢–ï–õ–¨–ù–´–• –î–û–ö–£–ú–ï–ù–¢–û–í
# ================================================================

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –£–ß–†–ï–î–ò–¢–ï–õ–¨–ù–´–• –î–û–ö–£–ú–ï–ù–¢–û–í (8 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

cd "$DOCS_DIR"

# –ú–∞—Å—Å–∏–≤ —É—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
charter_docs=(
    "–£—Å—Ç–∞–≤-–ö–§–ê-2025-10-23.md"
    "–ü–æ–ª–æ–∂–µ–Ω–∏–µ-–æ-—á–ª–µ–Ω—Å—Ç–≤–µ-–ö–§–ê.md"
    "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è-–∫-–ü–æ–ª–æ–∂–µ–Ω–∏—é-–æ-—á–ª–µ–Ω—Å—Ç–≤–µ-–ö–§–ê.md"
    "–ë–∞–∑–æ–≤—ã–µ-—Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã-–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π-–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-–ö–§–ê.md"
    "–ö–æ–¥–µ–∫—Å-–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π-—ç—Ç–∏–∫–∏-–ö–§–ê.md"
    "–†–µ–≥–ª–∞–º–µ–Ω—Ç-–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞-–ö–§–ê.md"
    "–†–µ–≥–ª–∞–º–µ–Ω—Ç-—Ä–∞–±–æ—Ç—ã-–°–æ–≤–µ—Ç–∞-–ö–§–ê.md"
    "–ù–ê–í–ò–ì–ê–¢–û–†-–î–û–ö–£–ú–ï–ù–¢–û–í-–ö–§–ê.md"
)

for doc in "${charter_docs[@]}"; do
    if [ -f "$doc" ]; then
        base_name="${doc%.md}"
        convert_to_pdf "$doc" "$PDF_DIR/charter/$base_name.pdf"
        convert_to_docx "$doc" "$DOCX_DIR/charter/$base_name.docx"
    else
        print_warning "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $doc"
    fi
done

# ================================================================
# –ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –†–ï–ì–£–õ–ò–†–£–Æ–©–ò–• –ü–û–õ–û–ñ–ï–ù–ò–ô
# ================================================================

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –†–ï–ì–£–õ–ò–†–£–Æ–©–ò–• –ü–û–õ–û–ñ–ï–ù–ò–ô (6 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

regulation_docs=(
    "–ü–æ–ª–æ–∂–µ–Ω–∏–µ-–æ-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤-–ö–§–ê.md"
    "–ü–æ–ª–æ–∂–µ–Ω–∏–µ-–æ-–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–º-–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏-–ö–§–ê.md"
    "–ü–æ–ª–æ–∂–µ–Ω–∏–µ-–æ-—Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ-—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–æ–π-–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-–ö–§–ê.md"
    "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–ø–æ–ª–æ–∂–µ–Ω–∏—è-–ö–§–ê.md"
)

for doc in "${regulation_docs[@]}"; do
    if [ -f "$doc" ]; then
        base_name="${doc%.md}"
        convert_to_pdf "$doc" "$PDF_DIR/regulations/$base_name.pdf"
        convert_to_docx "$doc" "$DOCX_DIR/regulations/$base_name.docx"
    else
        print_warning "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $doc"
    fi
done

# ================================================================
# –ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –í–ï–ë-–î–û–ö–£–ú–ï–ù–¢–û–í
# ================================================================

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –í–ï–ë-–î–û–ö–£–ú–ï–ù–¢–û–í (2 –¥–æ–∫—É–º–µ–Ω—Ç–∞)"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

cd "$DOCS_DIR/web"

web_docs=(
    "–ü–æ–ª–∏—Ç–∏–∫–∞-–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏-—Å–∞–π—Ç–∞-–ö–§–ê.md"
    "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ-—Å–æ–≥–ª–∞—à–µ–Ω–∏–µ-—Å–∞–π—Ç–∞-–ö–§–ê.md"
)

for doc in "${web_docs[@]}"; do
    if [ -f "$doc" ]; then
        base_name="${doc%.md}"
        convert_to_pdf "$doc" "$PDF_DIR/web/$base_name.pdf"
        convert_to_docx "$doc" "$DOCX_DIR/web/$base_name.docx"
    else
        print_warning "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $doc"
    fi
done

# ================================================================
# –ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –û–ü–ï–†–ê–¶–ò–û–ù–ù–´–• –§–û–†–ú
# ================================================================

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –û–ü–ï–†–ê–¶–ò–û–ù–ù–´–• –§–û–†–ú (10 —Ñ–æ—Ä–º –≤ 4 —Ñ–∞–π–ª–∞—Ö)"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

cd "$DOCS_DIR/forms"

form_docs=(
    "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ-–æ-–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏-NDA.md"
    "–î–æ–≥–æ–≤–æ—Ä-–æ-—á–ª–µ–Ω—Å—Ç–≤–µ-–≤-–ö–§–ê.md"
    "–§–æ—Ä–º—ã-–¥–ª—è-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è-–∏-–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π-–ö–§–ê.md"
    "–§–æ—Ä–º—ã-–¥–ª—è-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤-–ö–§–ê.md"
)

for doc in "${form_docs[@]}"; do
    if [ -f "$doc" ]; then
        base_name="${doc%.md}"
        convert_to_pdf "$doc" "$PDF_DIR/forms/$base_name.pdf"
        convert_to_docx "$doc" "$DOCX_DIR/forms/$base_name.docx"
    else
        print_warning "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $doc"
    fi
done

# ================================================================
# –°–û–ó–î–ê–ù–ò–ï –ê–†–•–ò–í–û–í
# ================================================================

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–°–û–ó–î–ê–ù–ò–ï –ê–†–•–ò–í–û–í –î–õ–Ø –°–ö–ê–ß–ò–í–ê–ù–ò–Ø"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

cd "$OUTPUT_DIR"

# –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤ PDF
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ PDF..."
zip -r "$ARCHIVES_DIR/KFA-Documents-Full-PDF.zip" pdf/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Documents-Full-PDF.zip"

# –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤ DOCX
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ DOCX..."
zip -r "$ARCHIVES_DIR/KFA-Documents-Full-DOCX.zip" docx/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Documents-Full-DOCX.zip"

# –£—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã PDF
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –£—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (PDF)..."
zip -r "$ARCHIVES_DIR/KFA-Charter-Documents-PDF.zip" pdf/charter/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Charter-Documents-PDF.zip"

# –£—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã DOCX
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –£—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (DOCX)..."
zip -r "$ARCHIVES_DIR/KFA-Charter-Documents-DOCX.zip" docx/charter/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Charter-Documents-DOCX.zip"

# –†–µ–≥—É–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è PDF
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –†–µ–≥—É–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è (PDF)..."
zip -r "$ARCHIVES_DIR/KFA-Regulations-PDF.zip" pdf/regulations/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Regulations-PDF.zip"

# –†–µ–≥—É–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è DOCX
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –†–µ–≥—É–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è (DOCX)..."
zip -r "$ARCHIVES_DIR/KFA-Regulations-DOCX.zip" docx/regulations/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Regulations-DOCX.zip"

# –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã PDF
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã (PDF)..."
zip -r "$ARCHIVES_DIR/KFA-Forms-PDF.zip" pdf/forms/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Forms-PDF.zip"

# –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã DOCX
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã (DOCX)..."
zip -r "$ARCHIVES_DIR/KFA-Forms-DOCX.zip" docx/forms/ >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Forms-DOCX.zip"

# –§–æ—Ä–º—ã –¥–ª—è —á–ª–µ–Ω—Å—Ç–≤–∞ (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è)
print_info "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: –§–æ—Ä–º—ã –¥–ª—è —á–ª–µ–Ω—Å—Ç–≤–∞..."
cd "$DOCX_DIR/forms"
zip "$ARCHIVES_DIR/KFA-Membership-Forms-DOCX.zip" \
    "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ-–æ-–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏-NDA.docx" \
    "–î–æ–≥–æ–≤–æ—Ä-–æ-—á–ª–µ–Ω—Å—Ç–≤–µ-–≤-–ö–§–ê.docx" \
    >> "$LOG_FILE" 2>&1
print_success "–°–æ–∑–¥–∞–Ω: KFA-Membership-Forms-DOCX.zip"

# ================================================================
# –°–¢–ê–¢–ò–°–¢–ò–ö–ê
# ================================================================

cd "$OUTPUT_DIR"

print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_info "–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

pdf_count=$(find pdf -name "*.pdf" | wc -l)
docx_count=$(find docx -name "*.docx" | wc -l)
archive_count=$(find archives -name "*.zip" | wc -l)

print_success "–°–æ–∑–¥–∞–Ω–æ PDF —Ñ–∞–π–ª–æ–≤: $pdf_count"
print_success "–°–æ–∑–¥–∞–Ω–æ DOCX —Ñ–∞–π–ª–æ–≤: $docx_count"
print_success "–°–æ–∑–¥–∞–Ω–æ –∞—Ä—Ö–∏–≤–æ–≤: $archive_count"

# –†–∞–∑–º–µ—Ä—ã –∞—Ä—Ö–∏–≤–æ–≤
print_info ""
print_info "–†–∞–∑–º–µ—Ä—ã –∞—Ä—Ö–∏–≤–æ–≤:"
for archive in archives/*.zip; do
    size=$(du -h "$archive" | cut -f1)
    name=$(basename "$archive")
    printf "  ${GREEN}‚úì${NC} %-45s %s\n" "$name" "$size"
done

# ================================================================
# –ó–ê–í–ï–†–®–ï–ù–ò–ï
# ================================================================

print_info ""
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
print_success "–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!"
print_info "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

print_info ""
print_info "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤:"
print_info "  üìÅ PDF: $PDF_DIR"
print_info "  üìÅ DOCX: $DOCX_DIR"
print_info "  üì¶ –ê—Ä—Ö–∏–≤—ã: $ARCHIVES_DIR"
print_info "  üìã –õ–æ–≥: $LOG_FILE"

echo "=== –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: $(date) ===" >> "$LOG_FILE"

print_info ""
print_success "–í—Å–µ —Ñ–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –≤–µ–±-—Å–∞–π—Ç –ö–§–ê!"
