# Инструкция по созданию таблицы новостей в Supabase

## Шаг 1: Откройте Supabase Dashboard

1. Перейдите на https://supabase.com/dashboard
2. Войдите в свой аккаунт
3. Выберите проект `eofneihisbhucxcydvac`

## Шаг 2: Откройте SQL Editor

1. В левом меню найдите раздел **SQL Editor**
2. Нажмите на него, чтобы открыть редактор SQL

## Шаг 3: Выполните SQL скрипт

1. Откройте файл `create-news-table.sql`
2. Скопируйте **весь** его содержимый
3. Вставьте в SQL Editor в Supabase
4. Нажмите кнопку **Run** (или нажмите Ctrl+Enter)

## Шаг 4: Проверьте создание таблицы

После выполнения скрипта вы должны увидеть сообщение:
```
Таблица news успешно создана!
```

## Шаг 5: Добавьте тестовые новости

Вернитесь в терминал и выполните:

```bash
node add-test-news.js
```

Это добавит 5 тестовых новостей в базу данных.

## Шаг 6: Проверьте результат

1. Откройте http://localhost:3000/dashboard/news
2. Вы должны увидеть список добавленных новостей

## Что было создано?

### Таблица `news` со следующими полями:
- `id` - уникальный идентификатор
- `title` - заголовок новости
- `slug` - URL-friendly версия заголовка
- `excerpt` - краткое описание
- `content` - полный текст (Markdown)
- `image` - URL изображения
- `featured_image_id` - связь с таблицей media
- `status` - статус (draft/published/archived)
- `featured` - избранное
- `author_id` - автор новости
- `published_at` - дата публикации
- `created_at` - дата создания
- `updated_at` - дата обновления

### Индексы для быстрого поиска:
- По slug
- По статусу
- По избранным
- По автору
- По дате публикации

### Row Level Security (RLS):
- Все могут читать опубликованные новости
- Аутентифицированные пользователи видят все новости
- Пользователи могут создавать, редактировать и удалять свои новости

### Автоматические триггеры:
- Автоматическое обновление поля `updated_at` при изменении записи

## Возможные проблемы

### Ошибка: "table already exists"
Если таблица уже существует, скрипт удалит её и создаст заново.

### Ошибка: "permission denied"
Убедитесь, что вы вошли в правильный проект Supabase с правами администратора.

### Ошибка: "foreign key constraint"
Если таблица `auth.users` не существует, это нормально - Supabase создаёт её автоматически при использовании Authentication.

## Дополнительная информация

После создания таблицы вы сможете:
- ✅ Добавлять новости через dashboard
- ✅ Редактировать существующие новости
- ✅ Удалять новости
- ✅ Фильтровать по статусу
- ✅ Искать по заголовку
- ✅ Просматривать новости на публичной странице /news

Если возникли проблемы, проверьте:
1. Правильность Supabase credentials в `.env`
2. Доступность Supabase API
3. Права доступа в вашем проекте
