# üì∏ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–µ–¥–∏–∞ –≤ Supabase

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –Ω–æ–≤–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
Could not find the table 'public.media' in the schema cache
```

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. ‚ùå –¢–∞–±–ª–∏—Ü–∞ `media` –Ω–µ —Å–æ–∑–¥–∞–Ω–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
2. ‚ùå Storage bucket `media` –Ω–µ —Å–æ–∑–¥–∞–Ω

## –†–µ—à–µ–Ω–∏–µ - 2 —à–∞–≥–∞

### –®–ê–ì 1: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `media`

#### 1.1 –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com/dashboard
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç (kfa-production)

#### 1.2 –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **SQL Editor**
2. –ù–∞–∂–º–∏—Ç–µ **New query**

#### 1.3 –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª **`CREATE-MEDIA-TABLE.sql`**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ (Ctrl+A, Ctrl+C)
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor (Ctrl+V)
4. –ù–∞–∂–º–∏—Ç–µ **Run** –∏–ª–∏ **F5**

‚úÖ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
Test media data inserted successfully
```

---

### –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å Storage Bucket

#### 2.1 –û—Ç–∫—Ä–æ–π—Ç–µ Storage

1. –í Supabase Dashboard –≤ –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **Storage**
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ **Storage**

#### 2.2 –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π bucket

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"New bucket"** (–≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞)
2. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤–≤–µ–¥–∏—Ç–µ:
   - **Name:** `media`
   - **Public bucket:** ‚úÖ **–í–∫–ª—é—á–∏—Ç–µ –≥–∞–ª–æ—á–∫—É** (—ç—Ç–æ –≤–∞–∂–Ω–æ!)
3. –ù–∞–∂–º–∏—Ç–µ **"Create bucket"**

#### 2.3 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è bucket

##### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π bucket **"media"**
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Policies"**
3. –ù–∞–∂–º–∏—Ç–µ **"New policy"**

**–ü–æ–ª–∏—Ç–∏–∫–∞ 1: –ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ**
- Policy name: `Public can read files`
- Allowed operations: ‚úÖ SELECT
- Target roles: `anon`, `authenticated`
- USING expression: `true`
- –ù–∞–∂–º–∏—Ç–µ **"Save policy"**

**–ü–æ–ª–∏—Ç–∏–∫–∞ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö**
- Policy name: `Authenticated users can upload`
- Allowed operations: ‚úÖ INSERT
- Target roles: `authenticated`
- WITH CHECK expression: `bucket_id = 'media'`
- –ù–∞–∂–º–∏—Ç–µ **"Save policy"**

**–ü–æ–ª–∏—Ç–∏–∫–∞ 3: –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —Ñ–∞–π–ª–æ–≤**
- Policy name: `Users can delete own files`
- Allowed operations: ‚úÖ DELETE
- Target roles: `authenticated`
- USING expression: `bucket_id = 'media' AND auth.uid() = owner`
- –ù–∞–∂–º–∏—Ç–µ **"Save policy"**

##### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ SQL

–ï—Å–ª–∏ UI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL –≤ SQL Editor:

```sql
-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è Storage bucket 'media'

CREATE POLICY "Anyone can read from media bucket"
ON storage.objects FOR SELECT
TO public
USING (bucket_id = 'media');

CREATE POLICY "Authenticated users can upload to media bucket"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK (bucket_id = 'media');

CREATE POLICY "Authenticated users can update their files"
ON storage.objects FOR UPDATE
TO authenticated
USING (bucket_id = 'media' AND auth.uid() = owner)
WITH CHECK (bucket_id = 'media' AND auth.uid() = owner);

CREATE POLICY "Authenticated users can delete their files"
ON storage.objects FOR DELETE
TO authenticated
USING (bucket_id = 'media' AND auth.uid() = owner);
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É media

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
SELECT COUNT(*) FROM public.media;
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: `1` (—Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Storage bucket

1. –û—Ç–∫—Ä–æ–π—Ç–µ Storage ‚Üí media
2. Bucket –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç—ã–º (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
3. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ **Public**

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://kfa-website.vercel.app/dashboard/news
2. –ù–∞–∂–º–∏—Ç–µ **"+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è:
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–¢–µ—Å—Ç–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º"
   - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (drag & drop) –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª
6. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä

‚úÖ –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## –ß—Ç–æ —Å–æ–∑–¥–∞—ë—Ç SQL —Å–∫—Ä–∏–ø—Ç

### –¢–∞–±–ª–∏—Ü–∞ `public.media`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| id | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID |
| filename | VARCHAR(255) | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ |
| original_filename | VARCHAR(255) | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ |
| path | VARCHAR(500) | –ü—É—Ç—å –≤ Storage |
| url | TEXT | –ü—É–±–ª–∏—á–Ω—ã–π URL —Ñ–∞–π–ª–∞ |
| mime_type | VARCHAR(100) | MIME —Ç–∏–ø (image/jpeg, image/png –∏ —Ç.–¥.) |
| size | BIGINT | –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö |
| width | INTEGER | –®–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–∏–∫—Å–µ–ª–∏) |
| height | INTEGER | –í—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–∏–∫—Å–µ–ª–∏) |
| alt_text | VARCHAR(255) | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è SEO |
| description | TEXT | –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ |
| collection | VARCHAR(100) | –ö–æ–ª–ª–µ–∫—Ü–∏—è/–ø–∞–ø–∫–∞ |
| uploader_id | UUID | –ö—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª (—Å—Å—ã–ª–∫–∞ –Ω–∞ auth.users) |
| created_at | TIMESTAMPTZ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| updated_at | TIMESTAMPTZ | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –ò–Ω–¥–µ–∫—Å—ã (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã)

- –ü–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- –ü–æ MIME —Ç–∏–ø—É (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø—É: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ –∏ —Ç.–¥.)
- –ü–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- –ü–æ –∑–∞–≥—Ä—É–∑—á–∏–∫—É
- –ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è

### RLS –ü–æ–ª–∏—Ç–∏–∫–∏

**–î–ª—è —Ç–∞–±–ª–∏—Ü—ã media:**
- ‚úÖ –í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∞–≤–æ–º `media.view` –≤–∏–¥—è—Ç –≤—Å—ë
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∞–≤–æ–º `media.upload` –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∞–≤–æ–º `media.edit` –º–æ–≥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∞–≤–æ–º `media.delete` –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å

**–î–ª—è Storage bucket:**
- ‚úÖ –í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º)
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ñ–∞–π–ª—ã

---

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "Could not find the table 'public.media'"

**–ü—Ä–∏—á–∏–Ω–∞:** SQL —Å–∫—Ä–∏–ø—Ç –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ CREATE-MEDIA-TABLE.sql –≤ SQL Editor

---

### –û—à–∏–±–∫–∞: "Bucket not found"

**–ü—Ä–∏—á–∏–Ω–∞:** Storage bucket –Ω–µ —Å–æ–∑–¥–∞–Ω

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–π—Ç–µ bucket `media` —á–µ—Ä–µ–∑ Storage UI

---

### –û—à–∏–±–∫–∞: "new row violates row-level security policy"

**–ü—Ä–∏—á–∏–Ω–∞:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –ø—Ä–∞–≤ `media.upload`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ permissions:

```sql
SELECT email, role, permissions
FROM public.profiles
WHERE email = 'admin@kfa.kg';
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `'media.upload', 'media.view', 'media.edit', 'media.delete'`

–ï—Å–ª–∏ –Ω–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
UPDATE public.profiles
SET permissions = ARRAY[
  'content.view', 'content.create', 'content.edit', 'content.delete', 'content.publish',
  'media.view', 'media.upload', 'media.edit', 'media.delete',
  'events.view', 'events.create', 'events.edit', 'events.delete',
  'members.view', 'members.edit',
  'partners.view', 'partners.create', 'partners.edit', 'partners.delete',
  'settings.view', 'settings.edit',
  'analytics.view', 'users.view', 'users.manage'
]
WHERE email = 'admin@kfa.kg';
```

---

### –û—à–∏–±–∫–∞: "Bucket is not public"

**–ü—Ä–∏—á–∏–Ω–∞:** Bucket —Å–æ–∑–¥–∞–Ω –∫–∞–∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π

**–†–µ—à–µ–Ω–∏–µ:**
1. Storage ‚Üí media ‚Üí Configuration
2. –í–∫–ª—é—á–∏—Ç–µ **"Public bucket"**
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

---

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è broken image icon)

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª–∏—Ç–∏–∫–∏ Storage –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏–ª–∏ bucket –ø—Ä–∏–≤–∞—Ç–Ω—ã–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ bucket **Public**
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–ª–∏—Ç–∏–∫–∞ `"Anyone can read from media bucket"` —Å–æ–∑–¥–∞–Ω–∞
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

## –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±–æ–∏—Ö —à–∞–≥–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ https://kfa-website.vercel.app/dashboard/news –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:

### –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

1. –ù–∞–∂–º–∏—Ç–µ **"+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å"**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   ```
   –ó–∞–≥–æ–ª–æ–≤–æ–∫: –ü–µ—Ä–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
   –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–µ–¥–∏–∞
   ```
3. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∑–æ–Ω—É –∑–∞–≥—Ä—É–∑–∫–∏
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ (–ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–µ–≤—å—é)
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**
6. –ù–æ–≤–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

### –í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

1. –ù–∞–∂–º–∏—Ç–µ **"+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å"**
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–í—ã–±—Ä–∞—Ç—å –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏"**
3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è MediaPicker —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
4. –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
5. –û–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—Å—è –≤ –Ω–æ–≤–æ—Å—Ç—å

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Storage –±—É–¥–µ—Ç:

```
media/
‚îú‚îÄ‚îÄ 1699999999999-abc123def456.jpg     ‚Üê –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
‚îú‚îÄ‚îÄ news/                               ‚Üê –ö–æ–ª–ª–µ–∫—Ü–∏—è "news"
‚îÇ   ‚îú‚îÄ‚îÄ 1700000000000-xyz789ghi012.jpg
‚îÇ   ‚îî‚îÄ‚îÄ 1700000000001-jkl345mno678.png
‚îî‚îÄ‚îÄ avatars/                            ‚Üê –ö–æ–ª–ª–µ–∫—Ü–∏—è "avatars"
    ‚îî‚îÄ‚îÄ 1700000000002-pqr901stu234.jpg
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã media
SELECT 'media table' as component, COUNT(*) as count FROM public.media;

-- 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã news
SELECT 'news table' as component, COUNT(*) as count FROM public.news;

-- 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞
SELECT
  'admin permissions' as component,
  CASE
    WHEN 'media.upload' = ANY(permissions) THEN 'OK'
    ELSE 'MISSING'
  END as media_upload,
  CASE
    WHEN 'content.create' = ANY(permissions) THEN 'OK'
    ELSE 'MISSING'
  END as content_create
FROM public.profiles
WHERE role = 'admin'
LIMIT 1;

-- 4. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª–∏—Ç–∏–∫ media
SELECT policyname, cmd FROM pg_policies
WHERE tablename = 'media' AND schemaname = 'public';

-- 5. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª–∏—Ç–∏–∫ Storage
SELECT policyname, cmd FROM pg_policies
WHERE tablename = 'objects' AND schemaname = 'storage';
```

–í—Å—ë –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å `OK` –∏ –Ω–µ –±—ã—Ç—å –ø—É—Å—Ç—ã–º.

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±–æ–∏—Ö —à–∞–≥–æ–≤:
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `media` —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ Storage bucket `media` —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –Ω–æ–≤–æ—Å—Ç–∏
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!**

https://kfa-website.vercel.app/dashboard/news
